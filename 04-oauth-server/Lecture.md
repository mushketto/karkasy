# Основні потоки серверу авторизації OAuth2
https://darutk.medium.com/diagrams-and-movies-of-all-the-oauth-2-0-flows-194f3c3ade85

## 1. Authorization Code Flow (Потік коду авторизації)
Цей потік використовується, коли є сторонній клієнт, який взаємодіє з сервером авторизації від імені користувача. Найпоширеніший для веб-додатків, де важлива безпека передачі облікових даних користувача.

### Процес:
1. Користувач переходить на сторінку авторизації сервера авторизації.
2. Користувач вводить свої облікові дані та дозволяє доступ клієнту до своїх ресурсів.
3. Сервер авторизації перенаправляє клієнта (додаток) на вказаний URI з **кодом авторизації**.
4. Клієнт надсилає запит до сервера авторизації для обміну коду авторизації на **токен доступу** (і, опціонально, **токен оновлення**).
5. Сервер авторизації повертає токен доступу клієнту.
![img_1.png](assets%2Fimg_1.png)
https://youtu.be/7D-OU4hZW70
---

## 2. Implicit Flow (Неявний потік)
Цей потік використовується для SPA (Single Page Application) або додатків, що працюють на стороні клієнта, де немає можливості безпечно зберігати облікові дані.

### Процес:
1. Користувач проходить авторизацію на сервері авторизації.
2. Сервер авторизації перенаправляє клієнта на вказаний URI з **токеном доступу**.
3. Клієнт отримує токен без необхідності обміну на сервері.

> **Мінус:** немає токену оновлення, токен доступу передається безпосередньо у відповідь на клієнтський запит, що менш безпечно.
![img_2.png](assets%2Fimg_2.png)
https://youtu.be/KUruB156-h4
---

## 3. Resource Owner Password Credentials Flow (Потік пароля власника ресурсу)
Цей потік використовується, коли додаток має високий рівень довіри до користувача (наприклад, офіційний мобільний додаток). У цьому випадку користувач передає свій логін і пароль безпосередньо клієнту.

### Процес:
1. Клієнт запитує у користувача логін і пароль.
2. Клієнт надсилає ці дані на сервер авторизації.
3. Сервер авторизації повертає **токен доступу** (і, опціонально, **токен оновлення**).

> **Мінус:** цей потік менш безпечний, оскільки облікові дані користувача передаються клієнту.
![img_3.png](assets%2Fimg_3.png)
https://youtu.be/CGMiOHrOAYQ
---

## 4. Client Credentials Flow (Потік клієнтських облікових даних)
Використовується, коли клієнт (додаток) самостійно аутентифікується на сервері авторизації без участі користувача (найчастіше для доступу до ресурсів на стороні сервера).

### Процес:
1. Клієнт передає свої облікові дані (ID клієнта і секрет клієнта) на сервер авторизації.
2. Сервер авторизації повертає **токен доступу**.

> **Цей потік використовується для машинної аутентифікації**, коли між сервісами потрібен доступ до ресурсів без участі кінцевого користувача.
![img_4.png](assets%2Fimg_4.png)
https://youtu.be/XJuFcXI2v2k
---

## 5. Refresh Token Flow (Потік оновлення токену)
Використовується для отримання нового токену доступу без повторної авторизації користувача, коли поточний токен доступу втратив чинність.

### Процес:
1. Клієнт передає **токен оновлення** на сервер авторизації.
2. Сервер авторизації повертає новий **токен доступу** (і, опціонально, новий **токен оновлення**).
![img_5.png](assets%2Fimg_5.png)
https://youtu.be/jcKDsQfBgYY
---

## Ключові елементи OAuth2:
- **Access Token (Токен доступу):** короткочасний токен для доступу до ресурсів.
- **Refresh Token (Токен оновлення):** використовується для отримання нового токену доступу без необхідності повторної авторизації.
- **Authorization Server (Сервер авторизації):** відповідає за видачу токенів.
- **Resource Server (Сервер ресурсів):** сервер, який містить захищені ресурси, до яких клієнт отримує доступ за допомогою токену.
